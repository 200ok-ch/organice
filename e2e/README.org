# -*- org -*-
* E2E Testing with Playwright

This directory contains end-to-end tests for organice using [[https://playwright.dev/][Playwright]].

** Running Tests

#+BEGIN_SRC shell
# Run all E2E tests (Chromium, Firefox, WebKIT, Mobile)
yarn test:e2e

# Run specific browser
yarn test:e2e --project=chromium

# Run with UI mode
yarn test:e2e:ui

# Run in debug mode
yarn test:e2e:debug

# Run in headed mode (show browser)
yarn test:e2e:headed

# View HTML report
yarn test:e2e:report

# Run Jest + Playwright
yarn test:all
#+END_SRC

** Writing New Tests

1. Create a new test file in the appropriate directory
2. Use the existing helpers for common operations
3. Follow the naming convention: =*.spec.js=
4. Use CSS selectors or data-testid attributes for reliability

*** Example Test

#+BEGIN_SRC javascript
import { test, expect } from '@playwright/test';

test.describe('My Feature', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/');
  });

  test('should do something', async ({ page }) => {
    const element = page.locator('.my-selector');
    await expect(element).toBeVisible();
    await element.click();
    await expect(page).toHaveURL('/new-page');
  });
});
#+END_SRC

** Test Helpers

*** E2ETestHelper

Common operations like navigation, element interaction, and waiting.

#+BEGIN_SRC javascript
import E2ETestHelper from '../helpers/test-helper';

const helper = new E2ETestHelper(page);
await helper.navigateTo('/sample');
await helper.clickElement('.my-button');
#+END_SRC

*** AuthHelper

Authentication flows for testing with and without sign-in.

#+BEGIN_SRC javascript
import AuthHelper from '../helpers/auth-helper';

const auth = new AuthHelper(page);
await auth.signInWithMock();
#+END_SRC

*** FixtureHelper

Access to test fixtures and Org file data from =test_helpers/fixtures/=.

#+BEGIN_SRC javascript
import FixtureHelper from '../helpers/fixture-helper';

const fixtures = new FixtureHelper();
const content = fixtures.readOrgFixture('all_the_features');
#+END_SRC

** Best Practices

- Use specific selectors (class names or data-testid)
- Keep tests isolated and independent
- Use auto-waiting (Playwright waits automatically)
- Test user flows, not implementation details
- Use =/sample= route for unauthenticated tests
- Target footer elements specifically with =.footer= prefix to avoid navbar matches

** Resources

- [[https://playwright.dev/][Playwright Documentation]]
- [[https://playwright.dev/docs/best-practices][Best Practices]]
